"0","# Required libraries"
"0","library(ggplot2)"
"0","library(gridExtra)"
"0",""
"0","# Ensure consistent width and x-axis scales"
"0","common_width <- 1  # Common width for tiles in both plots"
"0","aspect_ratio_p1 <- 12 / 7"
"0","aspect_ratio_p2 <- 1.5"
"0",""
"0","# Plotting main heatmap"
"0","p1 <- ggplot(Taxa_long, aes(x = ColumnName, y = RowNames, fill = Value)) +"
"0","  geom_tile(width = common_width, color = ""grey60"") +"
"0","  scale_fill_gradientn(colors = colorRampPalette(rev(rwbcols))(100)) +"
"0","  theme_minimal() +"
"0","  theme("
"0","    axis.text.x = element_text(size = 5, angle = 45, hjust = 1),"
"0","    axis.text.y = element_text(size = 6),"
"0","    axis.title = element_blank(),"
"0","    legend.title = element_text(size = 7),  # Smaller legend title"
"0","    legend.text = element_text(size = 7),  # Smaller legend text"
"0","    legend.key.size = unit(0.4, ""cm"")  # Smaller legend keys"
"0","  ) +"
"0","  coord_fixed(ratio = aspect_ratio_p1) +"
"0","  scale_x_discrete(position = ""bottom"")  # Ensuring the x-axis is at the bottom"
"0",""
"0","# Plotting the annotation data with customized axis labels"
"0","p2 <- ggplot(annotation_table_long, aes(x = Publication, y = Parameter, fill = Value)) +"
"0","  geom_tile(width = common_width, height = 0.8, color = ""grey60"") +"
"0","  scale_fill_manual(values = all_colors) +"
"0","  theme_void() +"
"0","  theme("
"0","    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 1, size = 7, color = ""black""),"
"0","    axis.text.y = element_text(angle = 0, hjust = 1, size = 8, color = ""black""),"
"0","    axis.title.x = element_text(size = 8, face = ""bold""),"
"0","    axis.title.y = element_text(size = 8, face = ""bold""),"
"0","    legend.title = element_text(size = 7),"
"0","    legend.text = element_text(size = 7),"
"0","    legend.key.size = unit(0.4, ""cm"")"
"0","  ) +"
"0","  labs("
"0","    x = ""Number of publication"","
"0","    y = "" "",  # Rename Y axis"
"0","    fill = ""Value"""
"0","  ) +"
"0","  coord_fixed(ratio = aspect_ratio_p2) +"
"0","  scale_x_discrete(position = ""top"")  # Position the x-axis at the top"
"0",""
"0","# Arrange plots including annotations (simple vertical arrangement example)"
"0","grid.arrange(p2, p1, ncol = 1, heights = c(1, 1.5))  # Adjusting heights ratio if necessary"
"0",""
